<HTML dir="ltr">
    <HEAD>
        <meta name="vs_showGrid" content="True">
        <TITLE>'Qt4 Designer Plugin Project'</TITLE>
        <META content="http://schemas.microsoft.com/intellisense/ie5" name="vs_targetSchema">
        <LINK ID="LINKURL" REL="stylesheet" HREF="../../1033/styles.css">
    </HEAD>
    <BODY onkeypress="OnPress();" onkeydown="OnKey();" bottomMargin="0" bgColor="buttonface"
        leftMargin="0" topMargin="0" onload="InitDocument(document);" rightMargin="0">
        <TABLE class="ONE" height="100%" cellSpacing="0" cellPadding="0" width="100%" border="0">
            <COLGROUP>
                <COL width="178">
                <COL>
                <!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
                <TR vAlign="top">
                    <TD width="100%" colSpan="2" height="79">
                        <TABLE class="TWO" cellSpacing="0" cellPadding="0" border="0">
                            <COLGROUP>
                                <COL width="12">
                                <COL>
                                <COL width="12">
                                <TR>
                                    <TD vAlign="top" width="12" height="12">&nbsp;
                                    </TD>
                                    <TD vAlign="top" height="12">&nbsp;
                                    </TD>
                                    <TD vAlign="top" width="12" height="12">&nbsp;
                                    </TD>
                                    <TD class="IMAGE" vAlign="bottom" width="110" rowSpan="2">
                                        <DIV class="SMALLA" id="Layer0"><IMG class="SMALLEST" height="63" alt="" src="..\..\Images\Qt4DesignerPluginProject.jpg" width="63"
                                                border="0">
                                        </DIV>
                                    </TD>
                                    <TD vAlign="top" width="6" height="12" rowSpan="2">&nbsp;
                                    </TD>
                                </TR>
                                <TR>
                                    <TD vAlign="top" width="12" height="65">&nbsp;
                                    </TD>
                                    <TD vAlign="top" height="65">
										<H4 class="HEAD" id="H4_1">Willkommen zum Qt4&nbsp;Designer Pluginprojektwizard</H4>
										<P class="SUBHEAD" id="P1">Dieser Wizard erstellt ein Designer Plugin, das Sie in Qt Designer oder Visual Studio verwenden können.</P>
									</TD>
                                    <TD vAlign="top" width="12" height="65">&nbsp;
                                    </TD>
                                </TR>
                                <TR>
                                    <TD class="RULE" vAlign="top" colSpan="5" height="2">
                                        <TABLE height="1" cellSpacing="0" cellPadding="0" width="100%" border="0">
                                            <TR vAlign="top">
                                                <TD width="100%" bgColor="buttonshadow" height="1"><IMG height="1" alt="" src="../../Images/spacer.gif" width="1"></TD>
                                                <TD width="1" bgColor="window" height="1"><IMG height="1" alt="" src="../../Images/spacer.gif" width="1"></TD>
                                            </TR>
                                        </TABLE>
                                    </TD>
                                </TR>
                        </TABLE>
                    </TD>
                </TR>
                <!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
                <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
                <TR vAlign="top">
                    <TD class="THREE"
                        vAlign="top" width="178" height="100%">
                        <!--OPEN OF NAVIGATION TABLE//-->
                        <TABLE class="THREE" cellSpacing="0" cellPadding="0" border="0">
                            <COLGROUP>
                                <COL width="12">
                                <COL width="166">
                                <COL width="1">
                                <TR>
                                    <TD vAlign="top" colSpan="3" height="12">&nbsp;
                                    </TD>
                                </TR>
                                <TR>
                                    <TD vAlign="top" width="12" height="100%">&nbsp;
                                    </TD>
                                    <TD vAlign="top" width="165" height="100%">
                                        <!--OPEN OF NAVIGATIONAL LINKS//-->
                                        <DIV class="LINK">
                                            <TABLE class="LINKTEXT" height="28" cellSpacing="0" cellPadding="0" width="166" border="0">
                                                <TR vAlign="middle">
                                                    <TD width="162"><SPAN class="ACTIVELINK" id="Page_1" title="" onclick="Next(document, 'default.htm');"
                                                            tabIndex="1">Übersicht</SPAN>
                                                    </TD>
                                                    <TD width="4"><IMG height="1" src="../../Images/spacer.gif" width="4">
                                                    </TD>
                                                </TR>
                                            </TABLE>
                                        </DIV>
                                        <DIV class="LINK">
                                            <TABLE class="LINKTEXT" height="28" cellSpacing="0" cellPadding="0" width="166" border="0"
                                                ID="Table1">
                                                <TR vAlign="middle">
                                                    <TD width="162"><SPAN class="ACTIVELINK" id="Page_2" title="" onclick="Next(document, 'Page_2.htm');"
                                                            tabIndex="1">Projekteinstellungen</SPAN>
                                                    </TD>
                                                    <TD width="4"><IMG height="1" src="../../Images/spacer.gif" width="4">
                                                    </TD>
                                                </TR>
                                            </TABLE>
                                        </DIV>
                                        <DIV class="LINKSELECTED"><SPAN class="VERTLINE1"><IMG height="1" alt="" src="../../Images/spacer.gif" width="1" border="0">
                                            </SPAN><SPAN class="HORILINE1">
                                                <TABLE height="100%" cellSpacing="0" cellPadding="0" width="167" border="0">
                                                    <TR vAlign="top">
                                                        <TD class="DOTTEDLINE" height="1"></TD>
                                                    </TR>
                                                    <TR vAlign="top">
                                                        <TD height="100%"><IMG height="28" alt="" src="../../Images/spacer.gif" width="1" border="0">
                                                        </TD>
                                                    </TR>
                                                    <TR vAlign="top">
                                                        <TD class="DOTTEDLINE" height="1"></TD>
                                                    </TR>
                                                </TABLE>
                                            </SPAN>
                                            <TABLE class="LINKTEXTSELECTED" height="28" cellSpacing="0" cellPadding="0" width="160"
                                                border="0">
                                                <TR vAlign="middle">
                                                    <TD width="162"><SPAN id="Page_3" title="" onclick="Next(document, 'Page_2.htm');" tabIndex="1">Generierte Klassen</SPAN>
                                                    </TD>
                                                    <TD width="4"><IMG height="1" src="../../Images/spacer.gif" width="4">
                                                    </TD>
                                                </TR>
                                            </TABLE>
                                        </DIV>
                                        <!--CLOSE OF NAVIGATIONAL LINKS//--></TD>
                                    <TD width="1">
                                        <DIV class="VERTLINE"><IMG height="1" alt="" src="../../Images/spacer.gif" width="1" border="0">
                                        </DIV>
                                    </TD>
                                </TR>
                        </TABLE>
                        <!--CLOSE OF NAVIGATION TABLE//--></TD>
                    <TD vAlign="top" height="100%">
                        <!--OPEN OF CONTENT AND BUTTON TABLE//-->
                        <TABLE class="ONE" cellSpacing="0" cellPadding="0" border="0">
                            <COLGROUP>
                                <COL width="100%">
                                <TR vAlign="top">
                                    <TD vAlign="top" height="100%">
                                        <!--OPEN OF CONTENT//-->
                                        <TABLE class="CONTENT" cellSpacing="0" cellPadding="0" border="0">
                                            <COLGROUP>
                                                <TR>
                                                    <TD width="12" height="12"></TD>
                                                    <TD height="12"></TD>
                                                    <TD height="12"></TD>
                                                    <TD width="12" height="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD width="12" height="26"></TD>
                                                    <TD height="12"><b>Custom Widget:</b></TD>
                                                    <TD height="12"></TD>
                                                    <TD width="12" height="12"></TD>
                                                </TR>                                                
                                                <TR>
                                                    <TD vAlign="top" width="12"></TD>
                                                    <TD vAlign="top">
                                                        Klassenname:</TD>
                                                    <TD vAlign="top">Basis Klasse:</TD>
                                                    <TD vAlign="top" width="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" width="12"></TD>
                                                    <TD vAlign="top"><INPUT id="CLASSNAME_TEXT" type="text" name="className" onPropertychange="ClassNameChanged();"></TD>
                                                    <TD vAlign="top"><INPUT id="BASECLASS_TEXT" type="text" name="baseClass"></TD>
                                                    <TD vAlign="top" width="12"></TD>
                                                </TR>                                                
                                                <TR>
                                                    <TD width="12" height="12"></TD>
                                                    <TD height="12"></TD>
                                                    <TD height="12"></TD>
                                                    <TD width="12" height="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" width="12"></TD>
                                                    <TD vAlign="top">.h Datei:</TD>
                                                    <TD vAlign="top">
                                                        <P>.cpp&nbsp;Datei:</P>
                                                    </TD>
                                                    <TD vAlign="top" width="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" width="12"></TD>
                                                    <TD vAlign="top">
                                                    <INPUT id="HFILE_TEXT" type="text" name="hFile">
                                                    </TD>
                                                    <TD vAlign="top">
                                                    <INPUT id="CPPFILE_TEXT" type="text" name="cppFile">
                                                    
                                                    </TD>
                                                    <TD vAlign="top" width="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD width="12" height="20"></TD>
                                                    <TD height="12"></TD>
                                                    <TD height="12"></TD>
                                                    <TD width="12" height="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD width="12" height="26"></TD>
                                                    <TD height="12"><b>Plugin Klasse:</b></TD>
                                                    <TD height="12"></TD>
                                                    <TD width="12" height="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" width="12"></TD>
                                                    <TD vAlign="top">
                                                        Klassenname:</TD>
                                                    <TD vAlign="top"></TD>
                                                    <TD vAlign="top" width="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" width="12"></TD>
                                                    <TD vAlign="top"><INPUT id="PLUGIN_CLASSNAME_TEXT" type="text" name="pluginClassName" onPropertychange="PluginClassNameChanged();"></TD>
                                                    <TD vAlign="top"></TD>
                                                    <TD vAlign="top" width="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD width="12" height="12"></TD>
                                                    <TD height="12"></TD>
                                                    <TD height="12"></TD>
                                                    <TD width="12" height="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" width="12"></TD>
                                                    <TD vAlign="top">.h Datei:</TD>
                                                    <TD vAlign="top">.cpp Datei:</TD>
                                                    <TD vAlign="top" width="12"></TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" width="12" style="HEIGHT: 19px"></TD>
                                                    <TD vAlign="top">
                                                            <INPUT id="PLUGIN_HFILE_TEXT" type="text" name="pluginHFile">
                                                    <TD vAlign="top">
															<INPUT id="PLUGIN_CPPFILE_TEXT" type="text" name="pluginCppFile">
                                                     </TD>
                                                    <TD vAlign="top" width="12" style="HEIGHT: 19px"></TD>
                                                <TR>
                                                    <TD vAlign="top" width="12" height="100%"></TD>
                                                    <TD vAlign="top" height="100%"></TD>
                                                    <TD vAlign="top" height="100%"></TD>
                                                    <TD vAlign="top" width="12" height="100%"></TD>
                                                </TR>
                                        </TABLE>
                                        <!--CLOSE OF CONTENT//--></TD>
                                </TR>
                                <TR vAlign="bottom">
                                    <TD height="48">
                                        <!--OPEN OF BUTTON HTML//-->
                                        <TABLE height="48" cellSpacing="0" cellPadding="0" border="0">
                                            <COLGROUP>
                                                <COL width="12">
                                                <COL>
                                                <COL width="75">
                                                <COL width="4">
                                                <COL width="75">
                                                <COL width="4">
                                                <COL width="75">
                                                <COL width="12">
                                                <TR>
                                                    <TD class="RULE" vAlign="top" colSpan="8" height="2">
                                                        <TABLE height="1" cellSpacing="0" cellPadding="0" width="100%" border="0">
                                                            <TR vAlign="top">
                                                                <TD width="100%" bgColor="buttonshadow" height="1"><IMG height="1" alt="" src="../../Images/spacer.gif" width="1"></TD>
                                                                <TD width="1" bgColor="window" height="1"><IMG height="1" alt="" src="../../Images/spacer.gif" width="1"></TD>
                                                            </TR>
                                                        </TABLE>
                                                    </TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" colSpan="8" height="11">&nbsp;
                                                    </TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="middle" width="12" height="23">&nbsp;
                                                    </TD>
                                                    <TD vAlign="top" height="23">&nbsp;
                                                    </TD>
                                                    <TD vAlign="middle" width="75" height="23"><BUTTON class="BUTTONS" id="FinishBtn" accessKey="B" onclick="OnFinish(document);" type="button"><U>B</U>eenden</BUTTON>
                                                    </TD>
                                                    <TD vAlign="middle" width="4" height="23">&nbsp;
                                                    </TD>
                                                    <TD vAlign="middle" width="75" height="23"><BUTTON class="BUTTONS" id="CancelBtn" accessKey="A" onclick="window.external.Finish(document, 'cancel');"
                                                            type="button"><U>A</U>bbrechen</BUTTON>
                                                    </TD>
                                                    <TD vAlign="middle" width="4" height="23">&nbsp;
                                                    </TD>
                                                    <TD vAlign="middle" width="75" height="23"><BUTTON class="BUTTONS" id="HelpBtn" disabled accessKey="H" onclick="window.external.OnHelp('vc.appwiz.custom.overview');"
                                                            type="button"><U>H</U>ilfe</BUTTON>
                                                    </TD>
                                                    <TD vAlign="middle" width="12" height="23">&nbsp;
                                                    </TD>
                                                </TR>
                                                <TR>
                                                    <TD vAlign="top" colSpan="8" height="12">&nbsp;
                                                    </TD>
                                                </TR>
                                        </TABLE>
                                        <!--CLOSE OF BUTTON HTML//--></TD>
                                </TR>
                        </TABLE>
                        <!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//--></TD>
                </TR>
        </TABLE>
    </BODY>
</HTML>


<SCRIPT language="JSCRIPT">

var tab_array = new Array();
tab_array[0] = Page_1;
tab_array[1] = Page_2;

// This is an example of a function which initializes the page
//
function InitDocument(document)
{
	setDirection();
	
	if (window.external.FindSymbol('DOCUMENT_FIRST_LOAD'))
	{
		// This function sets the default symbols based 
		// on the values specified in the SYMBOL tags above
		//
		window.external.SetDefaults(document);
	}

	// Load the document and initialize the controls 
	// with the appropriate symbol values
	//
	window.external.Load(document);
}

function ClassNameChanged()
{
	HFILE_TEXT.value = CLASSNAME_TEXT.value.toLowerCase() + ".h";
	CPPFILE_TEXT.value = CLASSNAME_TEXT.value.toLowerCase() + ".cpp";
}

function PluginClassNameChanged()
{
	PLUGIN_HFILE_TEXT.value = PLUGIN_CLASSNAME_TEXT.value.toLowerCase() + ".h";
	PLUGIN_CPPFILE_TEXT.value = PLUGIN_CLASSNAME_TEXT.value.toLowerCase() + ".cpp";
}

function ValidateAndUpdate()
{
    var Inputs = document.all.tags("INPUT");

    var regexp = /\s/g;
    var proName = window.external.FindSymbol('PROJECT_NAME').replace(regexp,"");

    var field = Inputs.item("className");
    if (!window.external.dte.VCLanguageManager.ValidateIdentifier(field.value) ||
    window.external.dte.VCLanguageManager.IsReservedName(field.value))
    {
        window.external.ReportError("Ungültiger Klassenname!");
        field.value = proName;
        return false;
    }

    var field = Inputs.item("hFile");
    if (!ValidateFileName(field.value))
    {
        window.external.ReportError("Ungültiger Dateiname!");
        field.value = proName.toLowerCase() + ".h";
        return false;
    }
    var field = Inputs.item("cppFile");
    if (!ValidateFileName(field.value))
    {
        window.external.ReportError("Ungültiger Dateiname!");
        field.value = proName.toLowerCase() + ".cpp";
        return false;
    }
    var field = Inputs.item("pluginHFile");
    if (!ValidateFileName(field.value))
    {
        window.external.ReportError("Ungültiger Dateiname!");
        field.value = proName.toLowerCase() + "plugin.h";
        return false;
    }
    var field = Inputs.item("pluginCppFile");
    if (!window.external.dte.VCLanguageManager.ValidateFileName(field.value))
    {
        window.external.ReportError("Ungültiger Dateiname!");
        field.value = proName.toLowerCase() + "plugin.cpp";
        return false;
    }
    var field = Inputs.item("pluginClassName");
    if (!window.external.dte.VCLanguageManager.ValidateIdentifier(field.value) ||
    window.external.dte.VCLanguageManager.IsReservedName(field.value))
    {
        window.external.ReportError("Ungültiger Klassenname!");
        field.value = proName + "Plugin";
        return false;
    }
    return true;
}

function ValidateFileName(FileName)
{
    if (!window.external.dte.VCLanguageManager.ValidateFileName(FileName))
        return false;
    if (FileName.search(/[\\\/\:\*\?\"\<\>\|]/g) != -1)
        return false;
    return true;
}


// If the wizard has more than 1 page, this 
// function will browse to the page specified
//
function Next(document, linkto)
{
    if (!ValidateAndUpdate())
        return;

    window.external.Next(document, linkto);
}

// This is an example of a function which
// gets called when the user clicks on 'Finish'
//
function OnFinish(document)
{
    if (!ValidateAndUpdate())
        return;

    OnWizFinish(document);
}

        </SCRIPT>
        <SCRIPT language="JSCRIPT" id="INCLUDE_SCRIPT"></SCRIPT>
        <SCRIPT language="JSCRIPT" id="INCLUDE_COMMON"></SCRIPT>
        <!-- 
Common.js is a script file which contains the helper functions 
used by the wizards.  Include this line if you want to
call these functions from your html scripts.
//-->
<SCRIPT>
	var strPath = window.external.FindSymbol("PRODUCT_INSTALLATION_DIR");
	strPath += "VCWizards/";
	strPath += window.external.GetHostLocale();

    // verify if the locale folder really exists
    var fso = new ActiveXObject("Scripting.FileSystemObject");
    var found = fso.FolderExists(strPath)
    if (found == false) {
        strPath = window.external.FindSymbol("PRODUCT_INSTALLATION_DIR");
	    strPath += "VCWizards/";
	    var folder = fso.GetFolder(strPath);
        for (subfolders = new Enumerator(folder.SubFolders); !subfolders.atEnd(); subfolders.moveNext())
        {
            for (files = new Enumerator(subfolders.item().files); !files.atEnd(); files.moveNext()) {
                if (files.item().name.toLowerCase().localeCompare("common.js") == 0) {
                    found = true;
                    strPath += subfolders.item().name;
                    break;              
                }
            }
            if (found == true)
                break;
        }
	}

    var strScriptPath = strPath + "/Script.js";
    var strCommonPath = strPath + "/Common.js";
    document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
    document.scripts("INCLUDE_COMMON").src = strCommonPath;
</SCRIPT>
